!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("underscore"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","underscore","react-dom"],t):"object"==typeof exports?exports.ReactGM=t(require("react"),require("underscore"),require("react-dom")):e.ReactGM=t(e.React,e.underscore,e.ReactDOM)}(this,function(e,t,a){return function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(9),i=n(r),o=a(3),l=n(o),u=a(4),s=n(u),c=a(7),f=(n(c),a(8)),p=n(f),d=a(6),m=n(d),h=a(10),v=n(h),g=a(5),y=n(g);a(11);var b={Grid:i.default,Pagination:l.default,PaginationText:s.default,Former:p.default,ValidateMixin:v.default,Validate:m.default,Util:y.default};t.default=b,e.exports=t.default},function(t,a){t.exports=e},function(e,a){e.exports=t},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r),o=i.default.createClass({displayName:"Pagination",propTypes:{data:i.default.PropTypes.shape({count:i.default.PropTypes.number.isRequired,offset:i.default.PropTypes.number.isRequired,limit:i.default.PropTypes.number.isRequired}),toPage:i.default.PropTypes.func.isRequired},render:function(){var e=Object.assign({},this.props.data);e.index=e.offset/e.limit+1;var t=2,a=[],n=Math.ceil(e.count/e.limit),r=Math.max(e.index-t,1),o=Math.min(e.index+t,n);n>2*t+1&&(1===r?o+=t:o===n&&(r-=t));for(var l=r;o>=l;l++)a.push(l);return i.default.createElement("div",{className:"gm-pagination"},i.default.createElement("ul",{className:"pagination pagination-sm",onClick:this.onPage},i.default.createElement("li",{className:1===e.index?"disabled":""},i.default.createElement("a",{href:"javascript:;","data-page":e.index-1},"上一页")),r>=2?i.default.createElement("li",null,i.default.createElement("a",{href:"javascript:;","data-page":"1"},"1")):void 0,r>=3?i.default.createElement("li",{className:"disabled"},i.default.createElement("a",{href:"javascript:;"},"...")):void 0,a.map(function(t,a){return i.default.createElement("li",{key:a,className:e.index===t?"active":""},i.default.createElement("a",{href:"javascript:;","data-page":t},t))}),n-2>=o?i.default.createElement("li",{className:"disabled"},i.default.createElement("a",{href:"javascript:;"},"...")):void 0,n-1>=o?i.default.createElement("li",null,i.default.createElement("a",{href:"javascript:;","data-page":n},n)):void 0,i.default.createElement("li",{className:e.index===n?"disabled":""},i.default.createElement("a",{href:"javascript:;","data-page":e.index+1},"下一页"))))},onPage:function(e){var t=~~e.target.getAttribute("data-page"),a=this.props.data,n=Math.ceil(a.count/a.limit),r=this.props.toPage;!t||t==a.index||1>t||t>n||r({offset:(t-1)*a.limit,limit:a.limit},t)}});t.default=o,e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r),o=i.default.createClass({displayName:"PaginationText",propTypes:{data:i.default.PropTypes.shape({count:i.default.PropTypes.number.isRequired,offset:i.default.PropTypes.number.isRequired,limit:i.default.PropTypes.number.isRequired})},render:function(){var e=this.props.data;return i.default.createElement("div",{className:"gm-pagination-text"},"显示第 ",e.offset+1," 到 ",Math.min(e.count,e.offset+e.limit-1)," 行，一共 ",e.count," 行记录")}});t.default=o,e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=n(r),o=function(e,t){var a=e;return arguments.length<2?a:a=a.replace(/\{([\d\w\.]+)\}/g,function(e){var a=arguments[1].split("."),n=null;return i.default.each(a,function(e,a){n=a?n[e]:t[e]}),n})},l={format:o};t.default=l,e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=n(r),o=a(5),l=n(o),u={"*":"\\*"},s={def:"请填写正确的信息！",w:{},reck:"两次输入的内容不一致！",ok:"通过信息验证！"},c={},f=[],p=function(e){var t={},a=i.default.map(i.default.keys(c),function(e){return u[e]?u[e]:e}).join("|"),n=new RegExp("^("+a+")((\\d*)((-)(\\d*))?)?$");return e.replace(n,function(){t.type=arguments[1],t.min=arguments[3],t.cross=arguments[4],t.max=arguments[6]}),t},d=function(e){if(i.default.isRegExp(e))return s.def;var t=p(e);return-1===f.indexOf(t.type)?t.max?l.default.format(s.w[t.type][3],t):t.cross?l.default.format(s.w[t.type][2],t):t.min?l.default.format(s.w[t.type][1],t):s.w[t.type][0]:s.w[t.type]||s.def},m=function(e,t,a){var n;if(a=a||!1,i.default.isRegExp(e))n=e.test(t);else{var r=p(e),o=["^",c[r.type]||r.type];-1===f.indexOf(r.type)&&(o=void 0===r.min?o.concat(["+"]):r.cross?o.concat(["{",r.min,",",void 0===r.max?"":r.max,"}"]):o.concat(["{",r.min,"}"])),n=new RegExp(o.concat(["$"]).join("")).test(t)}return n?!0:a?d(e):!1};m.factory=function(e,t){var a=i.default.extend({range:!1},t());s.w[e]=a.tip,c[e]=a.rule,a.range===!1&&f.push(e)},m.factory("*",function(){return{range:!0,rule:"[\\w\\W]",tip:["不能为空！","请填写{min}位任意字符！","请填写至少{min}位任意字符！","请填写{min}到{max}位任意字符！"]}}),m.factory("n",function(){return{range:!0,rule:"\\d",tip:["请填写数字！","请填写{min}位数字！","请填写至少{min}位数字！","请填写{min}到{max}位数字！"]}}),m.factory("s",function(){return{range:!0,rule:"[\\u4E00-\\u9FA5\\uf900-\\ufa2d\\w\\.\\s]",tip:["不能输入特殊字符！","请填写{min}位字符！","请填写至少{min}位字符！","请填写{min}到{max}位字符！"]}}),m.factory("l",function(){return{range:!0,rule:"[a-zA-Z]",tip:["请填写字母！","请填写{min}位字母！","请填写至少{min}位字母！","请填写{min}到{max}位字母！"]}}),m.factory("nl",function(){return{range:!0,rule:"[a-zA-Z0-9]",tip:["请填写字母或数字！","请填写{min}位字母或数字！","请填写至少{min}位字母或数字！","请填写{min}到{max}位字母或数字！"]}}),m.factory("zh",function(){return{range:!0,rule:"[\\u4e00-\\u9fa5]",tip:["请填写汉字！","请填写{min}位汉字！","请填写至少{min}位汉字！","请填写{min}到{max}位汉字！"]}}),m.factory("p",function(){return{rule:"[0-9]{6}",tip:"请填写邮政编码"}}),m.factory("m",function(){return{rule:"13[0-9]{9}$|14[0-9]{9}|15[0-9]{9}$|18[0-9]{9}",tip:"请填写手机号码"}}),m.factory("e",function(){return{rule:"\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*",tip:"请填写邮件地址"}}),m.factory("url",function(){return{rule:"(\\w+:\\/\\/)?\\w+(\\.\\w+)+.*",tip:"请填写网址"}}),m.factory("num",function(){return{rule:"[+-]?((\\d+.\\d+)|(\\d+))",tip:"请填写数字！"}}),t.default=m,e.exports=t.default},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=function(e,t,a){for(var n=!0;n;){var r=e,i=t,o=a;l=s=u=void 0,n=!1,null===r&&(r=Function.prototype);var l=Object.getOwnPropertyDescriptor(r,i);if(void 0!==l){if("value"in l)return l.value;var u=l.get;return void 0===u?void 0:u.call(o)}var s=Object.getPrototypeOf(r);if(null===s)return void 0;e=s,t=i,a=o,n=!0}},l=a(1),u=function(e){function t(e,a){n(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a),this.onClick=this.onClick.bind(this),this.onDragEnter=this.onDragEnter.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDrop=this.onDrop.bind(this),this.state={isDragActive:!1}}return r(t,e),i(t,[{key:"componentDidMount",value:function(){this.enterCounter=0}},{key:"accept",value:function(e,t){if(e&&t){var a=function(){var a=t.split(","),n=e.name||"",r=e.type||"",i=r.replace(/\/.*$/,"");return{v:a.some(function(e){var t=e.trim();return"."===t.charAt(0)?n.toLowerCase().endsWith(t.toLowerCase()):/\/\*$/.test(t)?i===t.replace(/\/.*$/,""):r===t})}}();if("object"==typeof a)return a.v}return!0}},{key:"allFilesAccepted",value:function(e){var t=this;return e.every(function(e){return t.accept(e,t.props.accept)})}},{key:"onDragEnter",value:function(e){e.preventDefault(),++this.enterCounter;var t=e.dataTransfer&&e.dataTransfer.items?e.dataTransfer.items:[],a=Array.prototype.slice.call(t),n=this.allFilesAccepted(a);this.setState({isDragActive:n,isDragReject:!n}),this.props.onDragEnter&&this.props.onDragEnter(e)}},{key:"onDragOver",value:function(e){e.preventDefault()}},{key:"onDragLeave",value:function(e){e.preventDefault(),--this.enterCounter>0||(this.setState({isDragActive:!1,isDragReject:!1}),this.props.onDragLeave&&this.props.onDragLeave(e))}},{key:"onDrop",value:function(e){e.preventDefault(),this.enterCounter=0,this.setState({isDragActive:!1,isDragReject:!1});for(var t=e.dataTransfer?e.dataTransfer.files:e.target.files,a=this.props.multiple?t.length:1,n=[],r=0;a>r;r++){var i=t[r];i.preview=window.URL.createObjectURL(i),n.push(i)}this.props.onDrop&&this.props.onDrop(n,e),this.allFilesAccepted(n)?this.props.onDropAccepted&&this.props.onDropAccepted(n,e):this.props.onDropRejected&&this.props.onDropRejected(n,e)}},{key:"onClick",value:function(){this.props.disableClick||this.open()}},{key:"open",value:function(){var e=this.refs.fileInput;e.value=null,e.click()}},{key:"render",value:function(){var e="gm-droper ";return e+=this.props.className?this.props.className:" gm-droper-default ",l.createElement("div",{className:e,onClick:this.onClick,onDragEnter:this.onDragEnter,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onDrop},this.props.children,l.createElement("input",{type:"file",ref:"fileInput",className:"gm-droper-input",multiple:this.props.multiple,accept:this.props.accept,onChange:this.onDrop}))}}]),t}(l.Component);u.defaultProps={disableClick:!1,multiple:!0},u.propTypes={onDrop:l.PropTypes.func,onDropAccepted:l.PropTypes.func,onDropRejected:l.PropTypes.func,onDragEnter:l.PropTypes.func,onDragLeave:l.PropTypes.func,disableClick:l.PropTypes.bool,multiple:l.PropTypes.bool,accept:l.PropTypes.string},e.exports=u},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o=a(1),l=n(o),u=l.default.createClass({displayName:"Form",getDefaultProps:function(){return{onSubmit:function(){}}},render:function(){return l.default.createElement("form",i({},this.props,{onSubmit:this.onSubmit,noValidate:!0}),this.props.children)},onSubmit:function(e){e.preventDefault(),this.props.onSubmit(e)}}),s={beforeField:function(){var e=this.props.label||this.props.name,t=this.___filed_id||"formerId"+(Math.random()+"").slice(2);this.___filed_id=t;var a=Object.assign({id:t,className:"form-control"},this.props);return-1===a.className.indexOf("form-control")&&(a.className="form-control "+a.className),{label:e,props:a}}},c=l.default.createClass({displayName:"Input",mixins:[s],render:function(){var e=Object.assign(this.beforeField(),{value:"",type:"text"},this.props),t=e.props,a=(t.children,r(t,["children"]));return l.default.createElement("div",{className:"form-group"},l.default.createElement("label",{htmlFor:e.props.id},e.label),l.default.createElement("input",a),this.props.children)}}),f=l.default.createClass({displayName:"Select",mixins:[s],render:function(){var e=Object.assign(this.beforeField(),{value:"",options:[]},this.props),t=e.props.options.map(function(e,t){return"object"!=typeof e&&(e={value:e,text:e}),l.default.createElement("option",{key:t,value:e.value},e.text)});return delete e.props.options,l.default.createElement("div",{className:"form-group"},l.default.createElement("label",{htmlFor:e.props.id},e.label),l.default.createElement("select",e.props,t,this.props.children))}}),p=u;Object.assign(p,{Input:c,Select:f}),t.default=p,e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r),o=a(3),l=n(o),u=a(4),s=n(u),c=i.default.createClass({displayName:"GridHead",render:function(){var e=this.props.data;return i.default.createElement("thead",null,i.default.createElement("tr",null,e.enableSelect?i.default.createElement("th",{className:"gm-grid-select"},i.default.createElement("input",{type:"checkbox",onClick:this.onSelect})):void 0,e.columns.map(function(e,t){return i.default.createElement("th",{key:t},e.name)}),e.actions.length>0?i.default.createElement("th",null,"操作"):void 0))},onSelect:function p(e){var p=this.props.onSelect;p(e.target.checked)}}),f=i.default.createClass({displayName:"Grid",processData:function(e){return e=Object.assign({enableSelect:!1,enablePagination:!1,enablePaginationText:!1,loading:!1,actions:[],batchs:[],list:[],toPage:function(){}},e),e.actions.forEach(function(e){e.isShow=e.isShow||function(){return!0}}),e.list.forEach(function(e){e.___select=!1}),e},getInitialState:function(){return{data:this.processData(this.props.data)}},componentWillReceiveProps:function(e){this.setState({data:this.processData(e.data)})},render:function(){var e,t=this,a=this.state.data,n=a.actions,r=a.batchs;a.loading?e=i.default.createElement("tr",null,i.default.createElement("td",{colSpan:"99",className:"text-center"},i.default.createElement("i",{className:"fa fa-spin fa-spinner fa-pulse"}))):0===a.list.length?e=i.default.createElement("tr",null,i.default.createElement("td",{colSpan:"99",className:"text-center"},"无")):a.list.length>0&&(e=a.list.map(function(e,r){var o=a.columns.map(function(t,a){return t.render?i.default.createElement("td",{key:a},t.render(e[t.field],e)):i.default.createElement("td",{key:a},e[t.field])}),l=n.map(function(a,n){var o="btn btn-default btn-xs "+a.className;return!!a.isShow(e,r)==!1&&(o+=" hidden"),i.default.createElement("button",{key:n,onClick:t.onActions.bind(t,e,r,a),className:o},a.text)});return i.default.createElement("tr",{key:r},a.enableSelect?i.default.createElement("td",null,i.default.createElement("input",{type:"checkbox",checked:e.___select,onClick:t.onSelect.bind(t,e)})):void 0,o,n.length>0?i.default.createElement("td",null,l):void 0)}));var o=r.map(function(e,a){var n="btn btn-default btn-sm "+e.className;return i.default.createElement("button",{key:a,onClick:t.onBatchs.bind(t,e),className:n},e.text)}),u=i.default.createElement("div",null,a.enablePagination?i.default.createElement("div",{className:"pull-right"},i.default.createElement(l.default,{data:a.pagination,toPage:t.onToPage})):void 0,a.enablePaginationText?i.default.createElement("div",{className:"pull-right"},i.default.createElement(s.default,{data:a.pagination})):void 0);return i.default.createElement("div",{className:"gm-grid"},i.default.createElement("table",{className:"table table-striped table-hover table-condensed table-bordered"},i.default.createElement(c,{data:a,onSelect:t.onSelectAll}),i.default.createElement("tbody",null,e)),i.default.createElement("div",{className:"gm-grid-foot clearfix"},i.default.createElement("div",{className:"pull-left gm-grid-batch"},a.enableSelect?o:void 0),a.pagination?u:void 0))},onActions:function(e,t,a){a.click(e,t)},onBatchs:function(e){var t=this.state.data.list.filter(function(e){return e.___select});t.length>0&&e.click(t)},onSelect:function(e,t){e.___select=t.target.checked,this.setState({list:this.state.data.list})},onSelectAll:function(e){this.setState({list:this.state.data.list.map(function(t){t.___select=e})})},onToPage:function(e,t){this.state.data.toPage(e,t)}});t.default=f,e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=(n(r),a(12)),o=n(i),l=a(2),u=n(l),s=a(6),c=n(s),f={error:"gm-invalid"},p=["onChange","onBlur","onFocus"],d=function g(e,t){if(t.props&&void 0!==t.props.name){var a;u.default.find(p,function(e){return t.props[e]?(a=t.props[e].___validate_rule,!0):void 0}),a&&e.push({name:t.props.name,rule:a})}else t.props&&t.props.children&&u.default.isArray(t.props.children)?u.default.each(t.props.children,function(t){g(e,t)}):t.props&&t.props.children&&u.default.isObject(t.props.children)&&g(e,t.props.children)},m=function(e){var t=[];return d(t,e),t},h=function(e,t,a){var n=a.value,r=a.name,i=c.default(t,n,!0);e.tip[r]=i,i===!0?a.className=u.default.without(a.className.split(" "),f.error).join(" "):a.className=u.default.union(a.className.split(" "),[f.error]).join(" ")},v=function(){var e={tip:{}};return{validate:function(t,a){var n=this,r=function(r){h(e,t,r.target),n.setState({}),a&&a.apply(n,arguments,e.tip[r.target.name])};return r.___validate_rule=t,r},validateAll:function(t){if(!t)return!1;var a=this,n=m(t),r=o.default.findDOMNode(t);return u.default.each(n,function(t){h(e,t.rule,r[t.name])}),a.setState({}),0===a.validateTip().length},validateTip:function(t){return t?e.tip[t]:u.default.map(u.default.filter(e.tip,function(e){return e!==!0}),function(e){return e})}}};t.default=v,e.exports=t.default},function(e,t){},function(e,t){e.exports=a}])});