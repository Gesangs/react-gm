!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):"object"==typeof exports?exports.ReactGM=t(require("react")):e.ReactGM=t(e.React)}(this,function(e){return function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),l=n(r),i=a(2),o=n(i),s=a(3),c=n(s),u=a(4),p=n(u);a(6),t.Grid=l.default,t.Pagination=o.default,t.PaginationText=c.default,t.Droper=p.default},function(t,a){t.exports=e},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),l=n(r),i=l.default.createClass({displayName:"Pagination",propTypes:{data:l.default.PropTypes.shape({count:l.default.PropTypes.number.isRequired,offset:l.default.PropTypes.number.isRequired,limit:l.default.PropTypes.number.isRequired}),toPage:l.default.PropTypes.func.isRequired},render:function(){var e=Object.assign({},this.props.data);e.index=e.offset/e.limit+1;var t=2,a=[],n=Math.ceil(e.count/e.limit),r=Math.max(e.index-t,1),i=Math.min(e.index+t,n);n>2*t+1&&(1===r?i+=t:i===n&&(r-=t));for(var o=r;i>=o;o++)a.push(o);return l.default.createElement("div",{className:"gm-pagination"},l.default.createElement("ul",{className:"pagination pagination-sm",onClick:this.onPage},l.default.createElement("li",{className:1===e.index?"disabled":""},l.default.createElement("a",{href:"javascript:;","data-page":e.index-1},"上一页")),r>=2?l.default.createElement("li",null,l.default.createElement("a",{href:"javascript:;","data-page":"1"},"1")):null,r>=3?l.default.createElement("li",{className:"disabled"},l.default.createElement("a",{href:"javascript:;"},"...")):null,a.map(function(t,a){return l.default.createElement("li",{key:a,className:e.index===t?"active":""},l.default.createElement("a",{href:"javascript:;","data-page":t},t))}),n-2>=i?l.default.createElement("li",{className:"disabled"},l.default.createElement("a",{href:"javascript:;"},"...")):null,n-1>=i?l.default.createElement("li",null,l.default.createElement("a",{href:"javascript:;","data-page":n},n)):null,l.default.createElement("li",{className:e.index===n?"disabled":""},l.default.createElement("a",{href:"javascript:;","data-page":e.index+1},"下一页"))))},onPage:function(e){var t=~~e.target.getAttribute("data-page"),a=this.props.data,n=Math.ceil(a.count/a.limit),r=this.props.toPage;!t||t==a.index||1>t||t>n||r({offset:(t-1)*a.limit,limit:a.limit},t)}});t.default=i,e.exports=t.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),l=n(r),i=l.default.createClass({displayName:"PaginationText",propTypes:{data:l.default.PropTypes.shape({count:l.default.PropTypes.number.isRequired,offset:l.default.PropTypes.number.isRequired,limit:l.default.PropTypes.number.isRequired})},render:function(){var e=this.props.data;return l.default.createElement("div",{className:"gm-pagination-text"},"显示第 ",e.offset+1," 到 ",Math.min(e.count,e.offset+e.limit-1)," 行，一共 ",e.count," 行记录")}});t.default=i,e.exports=t.default},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(e,t,a){for(var n=!0;n;){var r=e,l=t,i=a;o=c=s=void 0,n=!1,null===r&&(r=Function.prototype);var o=Object.getOwnPropertyDescriptor(r,l);if(void 0!==o){if("value"in o)return o.value;var s=o.get;return void 0===s?void 0:s.call(i)}var c=Object.getPrototypeOf(r);if(null===c)return void 0;e=c,t=l,a=i,n=!0}},o=a(1),s=function(e){function t(e,a){n(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a),this.onClick=this.onClick.bind(this),this.onDragEnter=this.onDragEnter.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDrop=this.onDrop.bind(this),this.state={isDragActive:!1}}return r(t,e),l(t,[{key:"componentDidMount",value:function(){this.enterCounter=0}},{key:"accept",value:function(e,t){if(e&&t){var a=function(){var a=t.split(","),n=e.name||"",r=e.type||"",l=r.replace(/\/.*$/,"");return{v:a.some(function(e){var t=e.trim();return"."===t.charAt(0)?n.toLowerCase().endsWith(t.toLowerCase()):/\/\*$/.test(t)?l===t.replace(/\/.*$/,""):r===t})}}();if("object"==typeof a)return a.v}return!0}},{key:"allFilesAccepted",value:function(e){var t=this;return e.every(function(e){return t.accept(e,t.props.accept)})}},{key:"onDragEnter",value:function(e){e.preventDefault(),++this.enterCounter;var t=e.dataTransfer&&e.dataTransfer.items?e.dataTransfer.items:[],a=Array.prototype.slice.call(t),n=this.allFilesAccepted(a);this.setState({isDragActive:n,isDragReject:!n}),this.props.onDragEnter&&this.props.onDragEnter(e)}},{key:"onDragOver",value:function(e){e.preventDefault()}},{key:"onDragLeave",value:function(e){e.preventDefault(),--this.enterCounter>0||(this.setState({isDragActive:!1,isDragReject:!1}),this.props.onDragLeave&&this.props.onDragLeave(e))}},{key:"onDrop",value:function(e){e.preventDefault(),this.enterCounter=0,this.setState({isDragActive:!1,isDragReject:!1});for(var t=e.dataTransfer?e.dataTransfer.files:e.target.files,a=this.props.multiple?t.length:1,n=[],r=0;a>r;r++){var l=t[r];l.preview=window.URL.createObjectURL(l),n.push(l)}this.props.onDrop&&this.props.onDrop(n,e),this.allFilesAccepted(n)?this.props.onDropAccepted&&this.props.onDropAccepted(n,e):this.props.onDropRejected&&this.props.onDropRejected(n,e)}},{key:"onClick",value:function(){this.props.disableClick||this.open()}},{key:"open",value:function(){var e=this.refs.fileInput;e.value=null,e.click()}},{key:"render",value:function(){var e="gm-droper ";return e+=this.props.className?this.props.className:" gm-droper-default ",o.createElement("div",{className:e,onClick:this.onClick,onDragEnter:this.onDragEnter,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onDrop},this.props.children,o.createElement("input",{type:"file",ref:"fileInput",className:"gm-droper-input",multiple:this.props.multiple,accept:this.props.accept,onChange:this.onDrop}))}}]),t}(o.Component);s.defaultProps={disableClick:!1,multiple:!0},s.propTypes={onDrop:o.PropTypes.func,onDropAccepted:o.PropTypes.func,onDropRejected:o.PropTypes.func,onDragEnter:o.PropTypes.func,onDragLeave:o.PropTypes.func,disableClick:o.PropTypes.bool,multiple:o.PropTypes.bool,accept:o.PropTypes.string},e.exports=s},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),l=n(r),i=a(2),o=n(i),s=a(3),c=n(s),u=l.default.createClass({displayName:"GridHead",render:function(){var e=this.props.data;return l.default.createElement("thead",null,l.default.createElement("tr",null,e.enableSelect?l.default.createElement("th",{className:"gm-grid-select"},l.default.createElement("input",{type:"checkbox",onClick:this.onSelect})):null,e.columns.map(function(e,t){return l.default.createElement("th",{key:t},e.name)}),e.actions.length>0?l.default.createElement("th",null,"操作"):null))},onSelect:function d(e){var d=this.props.onSelect;d(e.target.checked)}}),p=l.default.createClass({displayName:"Grid",processData:function(e){return e=Object.assign({enableSelect:!1,enablePagination:!1,enablePaginationText:!1,loading:!1,actions:[],batchs:[],list:[],toPage:function(){}},e),e.actions.forEach(function(e){e.isShow=e.isShow||function(){return!0}}),e.list.forEach(function(e){e.___select=!1}),e},getInitialState:function(){return{data:this.processData(this.props.data)}},componentWillReceiveProps:function(e){this.setState({data:this.processData(e.data)})},render:function(){var e,t=this,a=this.state.data,n=a.actions,r=a.batchs;a.loading?e=l.default.createElement("tr",null,l.default.createElement("td",{colSpan:"99",className:"text-center"},l.default.createElement("i",{className:"fa fa-spin fa-spinner fa-pulse"}))):0===a.list.length?e=l.default.createElement("tr",null,l.default.createElement("td",{colSpan:"99",className:"text-center"},"无")):a.list.length>0&&(e=a.list.map(function(e,r){var i=a.columns.map(function(t,a){return t.render?l.default.createElement("td",{key:a},""+t.render(e[t.field],e)):l.default.createElement("td",{key:a},""+e[t.field])}),o=n.map(function(a,n){var i="btn btn-default btn-xs "+a.className;return a.isShow(e,r)===!1&&(i+=" hidden"),l.default.createElement("button",{key:n,onClick:t.onActions.bind(t,e,r,a),className:i},a.text)});return l.default.createElement("tr",{key:r},a.enableSelect?l.default.createElement("td",null,l.default.createElement("input",{type:"checkbox",checked:e.___select,onClick:t.onSelect.bind(t,e)})):null,i,n.length>0?l.default.createElement("td",null,o):null)}));var i=r.map(function(e,a){var n="btn btn-default btn-sm "+e.className;return l.default.createElement("button",{key:a,onClick:t.onBatchs.bind(t,e),className:n},e.text)}),s=l.default.createElement("div",null,a.enablePagination?l.default.createElement("div",{className:"pull-right"},l.default.createElement(o.default,{data:a.pagination,toPage:t.onToPage})):null,a.enablePaginationText?l.default.createElement("div",{className:"pull-right"},l.default.createElement(c.default,{data:a.pagination})):null);return l.default.createElement("div",{className:"gm-grid"},l.default.createElement("table",{className:"table table-striped table-hover table-condensed table-bordered"},l.default.createElement(u,{data:a,onSelect:t.onSelectAll}),l.default.createElement("tbody",null,e)),l.default.createElement("div",{className:"gm-grid-foot clearfix"},l.default.createElement("div",{className:"pull-left gm-grid-batch"},a.enableSelect?i:null),a.pagination?s:null))},onActions:function(e,t,a){a.click(e,t)},onBatchs:function(e){var t=this.state.data.list.filter(function(e){return e.___select});t.length>0&&e.click(t)},onSelect:function(e,t){e.___select=t.target.checked,this.setState({list:this.state.data.list})},onSelectAll:function(e){this.setState({list:this.state.data.list.map(function(t){t.___select=e})})},onToPage:function(e,t){this.state.data.toPage(e,t)}});t.default=p,e.exports=t.default},function(e,t){}])});